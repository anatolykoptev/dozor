# Dozor Configuration
# All settings are optional — dozor works zero-config for local Docker setups.
# See docs/CONFIGURATION.md for detailed descriptions of every variable.

# ── Host ──────────────────────────────────────────────
DOZOR_HOST=local                    # local, localhost, 127.0.0.1, or SSH user@host
# DOZOR_SSH_PORT=22                 # SSH port (only for remote hosts)
DOZOR_TIMEOUT=30                    # Command timeout in seconds
DOZOR_MCP_PORT=8765                 # MCP HTTP server port
# DOZOR_WORKSPACE=~/.dozor          # Workspace path (IDENTITY.md, MEMORY.md, AGENTS.md)

# ── Docker Compose ────────────────────────────────────
# DOZOR_COMPOSE_PATH=~/myproject    # Auto-detected if not set (searches cwd, home)
# DOZOR_SERVICES=web,api,postgres   # Auto-discovered if not set

# ── Systemd Services ─────────────────────────────────
# DOZOR_SYSTEMD_SERVICES=nginx,myapp  # Local systemd services to monitor
# DOZOR_USER_SERVICES=myapp:8080,worker:9090  # User-level systemd services (name:port)
# DOZOR_USER_SERVICES_USER=                    # Linux user for user-level systemd

# ── Remote Server ─────────────────────────────────────
# DOZOR_REMOTE_HOST=user@server.com   # SSH access to remote server
# DOZOR_REMOTE_URL=https://example.com  # HTTP(S) URL to check availability + SSL
# DOZOR_REMOTE_SERVICES=nginx,php-fpm   # Remote systemd services to check via SSH
# DOZOR_REMOTE_SSH_PORT=22             # SSH port for remote server (default 22)

# ── Watch Mode ────────────────────────────────────────
# DOZOR_WEBHOOK_URL=                  # Webhook URL for alert notifications
DOZOR_WATCH_INTERVAL=4h              # Health check interval

# ── Alert Thresholds ─────────────────────────────────
DOZOR_CPU_THRESHOLD=90               # CPU usage alert threshold (%)
DOZOR_MEMORY_THRESHOLD=90            # Memory usage alert threshold (%)
DOZOR_DISK_THRESHOLD=80              # Disk usage warning threshold (%)
DOZOR_DISK_CRITICAL=95               # Disk usage critical threshold (%)
DOZOR_ERROR_THRESHOLD=5              # Error count alert threshold
DOZOR_RESTART_THRESHOLD=1            # Restart count alert threshold
DOZOR_LOG_LINES=100                  # Default log lines to analyze

# ── Command Execution Security ───────────────────────
# DOZOR_EXEC_SECURITY=ask             # safe (blocklist), ask (Telegram approval), full (unrestricted)
# DOZOR_REQUIRED_AUTH_VARS=           # Auth env vars to check in compose config

# ── Binary Updates ────────────────────────────────────
# DOZOR_TRACKED_BINARIES=cli/cli:gh,jesseduffield/lazygit  # owner/repo:binary (comma-separated)
# DOZOR_GITHUB_TOKEN=                 # GitHub token for higher API rate limits (60/hr -> 5000/hr)

# ── LLM (required for gateway mode) ──────────────────
# DOZOR_LLM_URL=http://127.0.0.1:8787/v1  # OpenAI-compatible API base URL
# DOZOR_LLM_MODEL=gemini-2.5-flash         # Model name
# DOZOR_LLM_API_KEY=                        # API key for LLM provider
# DOZOR_MAX_TOOL_ITERATIONS=10              # Max tool call iterations per request

# ── LLM Fallback (optional) ──────────────────────────
# DOZOR_LLM_FALLBACK_URL=                   # Fallback API base URL
# DOZOR_LLM_FALLBACK_MODEL=                 # Fallback model name
# DOZOR_LLM_FALLBACK_API_KEY=               # Fallback API key

# ── A2A Protocol (optional, for multi-agent) ─────────
# DOZOR_A2A_SECRET=                         # Bearer token for A2A endpoint auth
# DOZOR_A2A_AGENTS=orchestrator=http://host:port,devops=http://host:port

# ── Remote MCP Servers (optional) ─────────────────────
# DOZOR_MCP_SERVERS=kb=http://127.0.0.1:8001/mcp  # Remote MCP servers (id=url,id=url)

# ── Knowledge Base (optional) ─────────────────────────
# DOZOR_KB_SERVER=memdb                     # MCP server ID for KB backend
# DOZOR_KB_USER=default                     # KB user ID
# DOZOR_KB_CUBE=default                     # KB cube/namespace
# DOZOR_KB_SEARCH_TOOL=search_memories      # MCP tool name for search
# DOZOR_KB_SAVE_TOOL=add_memory             # MCP tool name for save

# ── Telegram Bot (optional) ───────────────────────────
# DOZOR_TELEGRAM_TOKEN=                     # Bot token from @BotFather
# DOZOR_TELEGRAM_ALLOWED=428660,123456      # Comma-separated allowed user IDs
# DOZOR_TELEGRAM_ADMIN=                     # Admin chat ID (defaults to first ALLOWED)

# ── Claude Code Escalation (optional) ────────────────
# DOZOR_CLAUDE_BINARY=claude                # Path to Claude Code CLI
# DOZOR_CLAUDE_TIMEOUT_SECONDS=300          # Session timeout (max 900)
# DOZOR_CLAUDE_MCP_ENABLED=true             # Pass Dozor tools to Claude via MCP
# DOZOR_CLAUDE_ALLOWED_TOOLS=mcp__dozor__*,Read,Bash(git*),Bash(ls*),Bash(cat*),Bash(find*),Bash(grep*)

# ── Web Search (optional) ─────────────────────────────
# DOZOR_DDG_ENABLED=true                    # DuckDuckGo (default, no API key needed)
# DOZOR_DDG_MAX_RESULTS=5
# DOZOR_BRAVE_ENABLED=false                 # Brave Search
# DOZOR_BRAVE_API_KEY=
# DOZOR_BRAVE_MAX_RESULTS=5
# DOZOR_PERPLEXITY_ENABLED=false            # Perplexity Search
# DOZOR_PERPLEXITY_API_KEY=
# DOZOR_PERPLEXITY_MAX_RESULTS=5
